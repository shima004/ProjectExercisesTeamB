{{ define "navibar" }}

<link rel="stylesheet" href="/static/css/navibar.css" />
<!-- ナビバー -->
<nav class="navbar navbar-light bg-light">
  <div class="container-fluid">
    <div class="navbar-header">
      <a class="navbar-brand" href="/">BGamesプロジェクト {{ .Title }}</a>
      <span class="navbar-brand" id="coin"></span>
    </div>
    <div class="navbar-brand">
      <a class="navbar-brand btn btn-outline-dark" style="display: none" href="/auth/signIn" id="signIn">Sign in</a>
      <a class="navbar-brand btn btn-outline-dark" style="display: none" href="/auth/signUp" id="signUp">Sign up</a>
      <a class="navbar-brand btn btn-outline-danger" style="display: none" id="signOut">Sign out</a>
      <a class="navbar-brand btn btn-outline-danger" id="get">get</a>
    </div>
  </div>
</nav>
<script>
  window.onload = async function () {
    toggleAuth();
    if (getToken() == undefined) {
      return;
    }
    var res = await getUser();
    if (res.coin != undefined) {
      document.getElementById("coin").innerHTML = "Coin: " + res.coin;
    } else {
      document.getElementById("coin").innerHTML = "";
    }
  };

  function toggleAuth() {
    if (getToken() == undefined) {
      document.getElementById("signOut").style.display = "none";
      document.getElementById("signIn").style.display = "inline-block";
      document.getElementById("signUp").style.display = "inline-block";
    } else {
      document.getElementById("signOut").style.display = "inline-block";
      document.getElementById("signIn").style.display = "none";
      document.getElementById("signUp").style.display = "none";
    }
  }

  $(function () {
    $("#signOut").on("click", function () {
      var $this = $(this);
      document.cookie = "token=token; max-age=0";
      document.getElementById("coin").innerHTML = "";
      toggleAuth();
    });
    $("#get").on("click", async function () {
      var res = await getUser();
      if (res.coin != undefined) {
        document.getElementById("coin").innerHTML = "Coin: " + res.coin;
      }
      console.log(res);
    });
  });
</script>
{{end}}
